{
    // Simple docker run configuration
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Apply configuration",
            "type": "shell",
            "command": "kubectl apply -f deployment.yaml"
        },
        {
            "label": "Restart rollout",
            "type": "shell",
            "command": "kubectl rollout restart deployment/appname-deployment"
        },
        {
            "label": "Build image",
            "type": "shell",
            "command": "docker build application -t registry:32000/appname-image:latest"
        },
        {
            "label": "Push image",
            "type": "shell",
            "command": "docker push registry:32000/appname-image:latest"
        },
        {
            "label": "Kubernetes deploy",
            "group": "build",
            "problemMatcher": [],
            "presentation": {
                "panel": "shared",
                "clear": true,
            },
            "dependsOrder": "sequence",
            "dependsOn": [
                "Build image",
                "Push image",
                "Apply configuration",
                "Restart rollout"
            ]
        },
        {
            "label": "Stop services",
            "type": "shell",
            "command": "docker-compose down --timeout 1"
        },
        {
            "label": "Start services",
            "type": "shell",
            "command": "docker-compose up --build"
        },
        {
            "label": "Compose deploy",
            "group": "build",
            "problemMatcher": [],
            "presentation": {
                "panel": "shared",
                "clear": true,
            },
            "dependsOrder": "sequence",
            "dependsOn": [
                "Stop services",
                "Start services"
            ]
        }
    ]
}